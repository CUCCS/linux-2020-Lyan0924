# 第三章实验
动手实战Systemd

### 实验环境
+ Ubuntu 18.04 Server 64bit
+ asciinema

### 实验要求
根据Systemd入门教程命令篇及实战篇进行操作，录制操作视频并分章节上传至asciinema

### 实验结果
asciinema操作录像  
命令篇  
+ [系统管理](https://asciinema.org/a/QBSY3E9D2VuipUb3BBYTSK84E)
+ [Unit](https://asciinema.org/a/UCA46x6Gwwu2WgqKPIQjVnou6)
+ [Unit配置文件](https://asciinema.org/a/fJ8HW7FBXxonPDDPDLe2HC5k5)
+ [Target+日志管理](https://asciinema.org/a/qoOYGWiDuYaO1lKeQRNG5tcfQ)

实战篇  
+ [实战](https://asciinema.org/a/zRgdG5BxDYnEG7Kv67kZf9DRo)

### 实验问题
+ 利用timedatectl set命令设置时间的时候报错：
Failed to set time: Automatic time synchronization is enabled  
解决方法：因为启动了自动同步时间，如果一定要改可以使用命令`timedatectl set-ntp no` 关闭时钟同步

+ 安装Apache2：`sudo apt-get install apache2`

### 自查清单
+ **如何添加一个用户并使其具备sudo执行程序的权限？如何将一个用户添加到一个用户组？**   
   
  ````
  adduser user #添加user用户
  sudo usermod -a -G sudo user #将user添加到sudo用户组中,就能具备sudo执行程序的权限
    ````
    ````
    usermod -a -G <group> <user>
    usermod -a -g <group> <user>
    #将用户user添加到用户组group  
    ````
  
+ **如何查看当前系统的分区表和文件系统详细信息？
如何实现开机自动挂载Virtualbox的共享目录分区?**   
`sudo fdisk -l`       列出磁盘分区基本信息   
`stat`命令查看文件/文件系统详细信息  

   实现开机自动挂载共享目录分区  
    `sudo ./VBoxLinuxAdditions.run` 安装增强功能，重启生效   
    + 方法一   
    在Virtualbox的设置中添加所要挂载的物理机分区为共享目录，勾选“自动挂载”，但这样只能挂载到ubuntu中的/media目录下的某个自动生成的文件下
    + 方法二  
  向ubuntu系统下的 /etc/fstab 文件中添加与共享文件夹相应的选项，来实现挂载，可挂载到自定义目录（设置中不勾选“自动挂载”）
        ````
        sudo mkdir /mnt/share       #创建共享文件的挂载目录
        vim /etc/fstab              #修改该文件

        #增加如下语句
        shared /mnt/share vboxsf defaults 0 0      #共享文件名 挂载点目录 用户组
        ````

+ **基于LVM（逻辑分卷管理）的分区如何实现动态扩容和缩减容量？**        
  `lvextend`命令增加容量  
  `lvreduce`命令缩减容量
+ **如何通过systemd设置实现在网络连通时运行一个指定脚本，在网络断开时运行另一个脚本？**  
  编辑指定脚本内的[Unit]区块  
  `After=network.target` 网络连通时运行    
  `Before=network.target`网络断开时启动

+ **如何通过systemd设置实现一个脚本在任何情况下被杀死之后会立即重新启动？实现杀不死？**  
    编辑指定脚本内的[Service]区块  
    `Restart = always`

### 实验参考
+ [Systemd 入门教程：命令篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html)
+ [Systemd 入门教程：实战篇](http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html)
+ [virtualBox下ubuntu18.04临时挂载和永久挂载共享文件的设置方法](https://blog.csdn.net/baidu_31788709/article/details/89154265)
